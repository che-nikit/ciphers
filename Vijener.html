<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=windows-1251">
  <title>Шифр Виженера</title>
  <script type="text/javascript">
function caesar_code(a) {
    var word = document.getElementById("b_text1").value,
        res = document.getElementById("b_text2"),
		key = document.getElementById("b_text3").value,
		b = " !.,?0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyzАБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯабвгдеёжзийклмнопрстуфхцчшщъыьэюя",
        e = "",
        f,tmp = "",
		arr = new Array(word.length),
		arr2 = new Array(word.length);
	if(key.length!=0)
	{
		while(tmp.length < word.length)
			tmp += key;
		key = tmp;
		if(key.length > b.length)
			key = key.substr(0,word.length);
		for(i = 0;i < word.length; i++)
		{
			arr[i] = b.lastIndexOf(key.charAt(i));
			if(arr[i] == -1)
				arr[i] = 0;
		}
		for(i = 0;i < word.length; i++)
		{
			arr2[i] = b.lastIndexOf(word.charAt(i));
			if(arr2[i] == -1)
				arr2[i] = 0;
		}
		for(i = 0;i < word.length; i++)
		{
			if(a == 0)
			{
				arr[i] += arr2[i];
				if(arr[i] > b.length-1)
					arr[i] -= b.length;
			}
			else
			{
				arr[i] = arr2[i] - arr[i];
				if(arr[i] < 0)
					arr[i] += b.length;
			}
			e += b.charAt(arr[i]);
		}
		res.value = e;
	}
	else 
	{
		res.value="";
		alert("Введите ключ!");
	}
};
  </script>
</head>
<body>
  <br>
  <div align="center">
	Реализация шифра Виженера.
	<br>
	<br>
    <strong>Введите исходный текст:</strong><br>
    <br>
    <input id="b_text1" type="text" size="100"><br>
    <br>
    <br>
    <strong>Выберите действие:</strong><br>
    <br>
	Введите ключевое слово
	<input id="b_text3" type="text" size="30"><br>
	<br>
    <input onclick="caesar_code(0)" type="button" value="Шифровать">
    <input onclick="caesar_code(1)" type="button" value="Дешифровать">
    <br>
    <br>
    <br>
    <strong>Зашифрованный текст:</strong><br>
    <br>
    <input id="b_text2" type="text" size="100">
  </div>
</body>
</html>
